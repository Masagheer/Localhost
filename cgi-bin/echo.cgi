#!/bin/bash

# Extract name parameter from query string
NAME=$(echo "$QUERY_STRING" | grep -oP '(?<=name=)[^&]*' | head -1)
NAME=${NAME:-"Guest"}
NAME=$(echo -e "$(echo $NAME | sed 's/+/ /g;s/%/\\x/g')")

echo "Status: 200 OK"
echo "Content-Type: text/html"
echo ""
echo "<!DOCTYPE html>"
echo "<html>"
echo "<head>"
echo "    <title>CGI Parameter Demo</title>"
echo "    <style>"
echo "        body { font-family: Arial, sans-serif; margin: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }"
echo "        .container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }"
echo "        h1 { color: #667eea; }"
echo "        .info { background: #f0f7ff; padding: 15px; border-left: 4px solid #667eea; margin: 10px 0; }"
echo "        .params { background: #f5f5f5; padding: 15px; border-radius: 4px; font-family: monospace; }"
echo "    </style>"
echo "</head>"
echo "<body>"
echo "    <div class='container'>"
echo "        <h1>ðŸ‘‹ Hello, $NAME!</h1>"
echo "        <p>This page was generated by a CGI script with parameter parsing.</p>"
echo "        <div class='info'>"
echo "            <h2>Query Parameters</h2>"
echo "            <div class='params'>"
echo "                QUERY_STRING: $QUERY_STRING<br>"
echo "                name parameter: $NAME"
echo "            </div>"
echo "        </div>"
echo "        <div class='info'>"
echo "            <h2>Try It</h2>"
echo "            <p>Visit <a href='/cgi-bin/echo.cgi?name=Alice'>?name=Alice</a> to greet Alice!</p>"
echo "            <p>Visit <a href='/cgi-bin/echo.cgi?name=Bob'>?name=Bob</a> to greet Bob!</p>"
echo "        </div>"
echo "    </div>"
echo "</body>"
echo "</html>"
